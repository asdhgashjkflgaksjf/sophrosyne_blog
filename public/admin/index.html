<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Sophrosyne Admin | Kelola Konten Blog</title>
  
  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" />
  
  <!-- Fonts - matching the blog design -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Lora:ital,wght@0,400;0,500;0,600;1,400&family=Spectral:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
  
  <!-- Custom Admin Styles - Vintage Paper Theme -->
  <style>
    /* CSS Variables for theming - LIGHT MODE */
    :root {
      --paper-cream: 45 30% 96%;
      --paper-cream-dark: 45 25% 92%;
      --ink-black: 30 15% 15%;
      --ink-muted: 30 10% 40%;
      --accent-sepia: 28 60% 45%;
      --accent-warm: 35 80% 50%;
      --border-aged: 35 20% 80%;
      --shadow-paper: 0 4px 20px rgba(139, 115, 85, 0.15);
      --grain-opacity: 0.03;
      
      /* Theme-aware tokens */
      --admin-bg: hsl(45 30% 94%);
      --admin-bg-secondary: hsl(45 25% 92%);
      --admin-surface: hsl(45 30% 97%);
      --admin-surface-hover: hsl(45 25% 93%);
      --admin-text: hsl(30 15% 15%);
      --admin-text-muted: hsl(30 10% 40%);
      --admin-border: hsl(35 20% 80%);
      --admin-accent: hsl(28 60% 45%);
      --admin-accent-hover: hsl(28 55% 40%);
    }

    /* DARK MODE */
    .dark {
      --paper-cream: 220 15% 13%;
      --paper-cream-dark: 220 15% 10%;
      --ink-black: 45 30% 96%;
      --ink-muted: 45 20% 70%;
      --accent-sepia: 35 70% 55%;
      --accent-warm: 35 80% 60%;
      --border-aged: 220 10% 25%;
      --shadow-paper: 0 4px 20px rgba(0, 0, 0, 0.4);
      
      /* Theme-aware tokens - Dark */
      --admin-bg: hsl(220 15% 10%);
      --admin-bg-secondary: hsl(220 15% 13%);
      --admin-surface: hsl(220 15% 16%);
      --admin-surface-hover: hsl(220 15% 20%);
      --admin-text: hsl(45 30% 96%);
      --admin-text-muted: hsl(45 15% 70%);
      --admin-border: hsl(220 10% 25%);
      --admin-accent: hsl(35 70% 55%);
      --admin-accent-hover: hsl(35 65% 50%);
    }

    /* Smooth transition for theme switch */
    *, *::before, *::after {
      transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease !important;
    }

    /* Paper grain texture */
    .paper-grain {
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='paper'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23paper)'/%3E%3C/svg%3E");
    }

    /* Base styles */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Lora', 'Georgia', serif;
      background: var(--admin-bg);
      min-height: 100vh;
    }

    /* ===== FIXED HEADER LAYOUT ===== */
    /* Force proper header structure - prevent overlapping */
    [class*="AppHeader"],
    header[class*="Header"],
    [class*="EditorHeader"] {
      display: flex !important;
      flex-direction: row !important;
      flex-wrap: nowrap !important;
      align-items: center !important;
      justify-content: space-between !important;
      padding: 0 16px !important;
      height: auto !important;
      min-height: 60px !important;
      gap: 16px !important;
      position: relative !important;
      z-index: 100 !important;
    }

    /* Header Left Section - Back button + Collection info */
    [class*="AppHeader"] > a:first-child,
    [class*="BackButton"],
    [class*="BackArrow"],
    header a[href*="collections"],
    [class*="Header"] [class*="LeftSection"],
    [class*="EditorHeader"] > div:first-child {
      flex-shrink: 0 !important;
      display: flex !important;
      align-items: center !important;
      gap: 12px !important;
      min-width: 0 !important;
    }

    /* Writing in + Collection name - Compact */
    [class*="BackStatus"],
    [class*="EditorHeader"] span,
    [class*="CollectionLabel"] {
      font-size: 13px !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
      max-width: 200px !important;
    }

    /* Header Center Section - Navigation Tabs */
    [class*="AppHeader"] nav,
    [class*="HeaderTabs"],
    [class*="EditorTabs"],
    [class*="Tabs"][class*="Header"],
    [class*="TabBar"] {
      position: absolute !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      display: flex !important;
      align-items: center !important;
      gap: 4px !important;
      background: var(--admin-surface-hover) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 12px !important;
      padding: 4px !important;
      z-index: 10 !important;
    }

    /* Tab buttons styling */
    [class*="HeaderTabs"] button,
    [class*="EditorTabs"] button,
    [class*="TabBar"] button,
    [class*="Tab"]:not([class*="Table"]) {
      background: transparent !important;
      border: none !important;
      border-radius: 8px !important;
      padding: 8px 16px !important;
      font-family: 'Lora', serif !important;
      font-size: 13px !important;
      font-weight: 500 !important;
      color: var(--admin-text-muted) !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
      display: flex !important;
      align-items: center !important;
      gap: 6px !important;
      white-space: nowrap !important;
    }

    [class*="HeaderTabs"] button:hover,
    [class*="EditorTabs"] button:hover,
    [class*="Tab"]:hover:not([class*="Table"]) {
      background: var(--admin-surface) !important;
      color: var(--admin-text) !important;
    }

    [class*="HeaderTabs"] button[class*="active"],
    [class*="EditorTabs"] button[class*="active"],
    [class*="Tab"][class*="active"]:not([class*="Table"]),
    [class*="TabBar"] button[aria-selected="true"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
    }

    /* Header Right Section - Save button + Quick Add + Theme toggle */
    [class*="AppHeader"] > div:last-child,
    [class*="Header"] [class*="RightSection"],
    [class*="EditorHeader"] > div:last-child,
    [class*="HeaderActions"] {
      flex-shrink: 0 !important;
      display: flex !important;
      align-items: center !important;
      gap: 12px !important;
      margin-left: auto !important;
    }

    /* Save Button - Clear styling */
    [class*="SaveButton"],
    button[class*="save"],
    [class*="Header"] button[class*="primary"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
      border: none !important;
      border-radius: 8px !important;
      padding: 8px 16px !important;
      font-size: 13px !important;
      font-weight: 500 !important;
      white-space: nowrap !important;
    }

    /* Quick Add Button */
    [class*="QuickAdd"],
    button[class*="quick"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 8px !important;
      padding: 8px 12px !important;
      font-size: 13px !important;
      white-space: nowrap !important;
    }

    /* ===== DARK MODE TOGGLE - REPOSITIONED ===== */
    .theme-toggle-container {
      position: relative !important;
      top: auto !important;
      right: auto !important;
      z-index: 99999;
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--admin-surface);
      border: 1px solid var(--admin-border);
      padding: 6px 10px;
      border-radius: 50px;
      box-shadow: none;
      flex-shrink: 0;
    }

    .theme-toggle-label {
      font-size: 11px;
      font-family: 'Cormorant Garamond', serif;
      font-weight: 600;
      color: var(--admin-text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .theme-toggle {
      position: relative;
      width: 44px;
      height: 24px;
      background: var(--admin-border);
      border-radius: 50px;
      cursor: pointer;
      border: none;
      padding: 0;
      transition: background 0.3s ease;
    }

    .dark .theme-toggle {
      background: var(--admin-accent);
    }

    .theme-toggle::before {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: var(--admin-surface);
      border-radius: 50%;
      transition: transform 0.3s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .dark .theme-toggle::before {
      transform: translateX(20px);
    }

    .theme-toggle-icon {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 14px;
      height: 14px;
      transition: opacity 0.3s ease;
    }

    .theme-toggle-icon.sun {
      left: 5px;
      opacity: 1;
    }

    .theme-toggle-icon.moon {
      right: 5px;
      opacity: 0.5;
    }

    .dark .theme-toggle-icon.sun {
      opacity: 0.5;
    }

    .dark .theme-toggle-icon.moon {
      opacity: 1;
    }

    /* ===== PREVIEW PANEL STYLES ===== */
    .preview-toggle-btn {
      background: linear-gradient(135deg, hsl(200 60% 45%) 0%, hsl(200 50% 40%) 100%) !important;
      color: white !important;
      border: none !important;
      border-radius: 8px !important;
      padding: 8px 14px !important;
      font-family: 'Lora', serif !important;
      font-size: 13px !important;
      font-weight: 500 !important;
      cursor: pointer !important;
      display: flex !important;
      align-items: center !important;
      gap: 6px !important;
      transition: all 0.2s ease !important;
      white-space: nowrap !important;
    }

    .preview-toggle-btn:hover {
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(66, 133, 164, 0.35) !important;
    }

    .preview-toggle-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Preview Sidebar Panel */
    #article-preview-panel {
      position: fixed;
      top: 0;
      right: -450px;
      width: 450px;
      height: 100vh;
      background: var(--admin-surface);
      border-left: 1px solid var(--admin-border);
      box-shadow: -10px 0 40px rgba(0,0,0,0.15);
      z-index: 99998;
      transition: right 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    #article-preview-panel.visible {
      right: 0;
    }

    .preview-header {
      background: var(--admin-surface-hover);
      border-bottom: 1px solid var(--admin-border);
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .preview-header h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 18px;
      font-weight: 600;
      color: var(--admin-text);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .preview-header h3 svg {
      width: 20px;
      height: 20px;
      color: var(--admin-accent);
    }

    .preview-close-btn {
      background: transparent;
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--admin-text-muted);
      transition: all 0.2s ease;
    }

    .preview-close-btn:hover {
      background: var(--admin-surface);
      color: var(--admin-text);
    }

    .preview-content {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
      background: var(--admin-bg);
    }

    /* Preview Article Styles */
    .preview-article {
      background: var(--admin-surface);
      border-radius: 12px;
      padding: 24px;
      border: 1px solid var(--admin-border);
    }

    .preview-article h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 24px;
      font-weight: 600;
      color: var(--admin-text);
      margin: 0 0 12px 0;
      line-height: 1.3;
    }

    .preview-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 16px;
      font-size: 13px;
      color: var(--admin-text-muted);
    }

    .preview-meta span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .preview-excerpt {
      font-family: 'Lora', serif;
      font-size: 15px;
      font-style: italic;
      color: var(--admin-text-muted);
      line-height: 1.7;
      padding: 16px;
      background: var(--admin-surface-hover);
      border-left: 3px solid var(--admin-accent);
      border-radius: 0 8px 8px 0;
      margin-bottom: 20px;
    }

    .preview-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 20px;
      background: var(--admin-surface-hover);
    }

    .preview-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    .preview-tag {
      background: var(--admin-accent);
      color: var(--admin-surface);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 500;
    }

    .preview-content-blocks {
      font-family: 'Spectral', serif;
      font-size: 15px;
      line-height: 1.8;
      color: var(--admin-text);
    }

    .preview-content-blocks h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      font-weight: 600;
      margin: 24px 0 12px;
      color: var(--admin-text);
    }

    .preview-content-blocks h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 18px;
      font-weight: 600;
      margin: 20px 0 10px;
      color: var(--admin-text);
    }

    .preview-content-blocks p {
      margin: 0 0 16px;
    }

    .preview-content-blocks blockquote {
      border-left: 3px solid var(--admin-accent);
      padding-left: 16px;
      margin: 20px 0;
      font-style: italic;
      color: var(--admin-text-muted);
    }

    .preview-placeholder {
      text-align: center;
      padding: 40px 20px;
      color: var(--admin-text-muted);
    }

    .preview-placeholder svg {
      width: 48px;
      height: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .preview-placeholder p {
      font-family: 'Lora', serif;
      font-size: 14px;
      margin: 0;
    }

    /* Refresh Preview Button */
    .preview-refresh-btn {
      background: var(--admin-surface);
      border: 1px solid var(--admin-border);
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      color: var(--admin-text-muted);
      transition: all 0.2s ease;
    }

    .preview-refresh-btn:hover {
      background: var(--admin-surface-hover);
      color: var(--admin-accent);
    }

    .preview-refresh-btn svg {
      width: 14px;
      height: 14px;
    }

    /* Overlay when preview is open */
    #preview-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0);
      z-index: 99997;
      pointer-events: none;
      transition: background 0.3s ease;
    }

    #preview-overlay.visible {
      background: rgba(0,0,0,0.3);
      pointer-events: auto;
    }

    @media (max-width: 768px) {
      #article-preview-panel {
        width: 100%;
        right: -100%;
      }
    }

    /* Loading screen */
    .admin-loading {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--admin-bg);
      z-index: 9999;
    }

    .admin-loading::before {
      content: '';
      position: absolute;
      inset: 0;
      opacity: 0.03;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='paper'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23paper)'/%3E%3C/svg%3E");
    }

    .loading-logo {
      width: 80px;
      height: 80px;
      background: var(--admin-accent);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      box-shadow: var(--shadow-paper);
      animation: pulse 2s ease-in-out infinite;
    }

    .loading-logo svg {
      width: 48px;
      height: 48px;
      color: var(--admin-surface);
    }

    .loading-title {
      font-family: 'Cormorant Garamond', 'Georgia', serif;
      font-size: 32px;
      font-weight: 600;
      color: var(--admin-text);
      margin-bottom: 8px;
    }

    .loading-subtitle {
      font-size: 14px;
      color: var(--admin-text-muted);
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .loading-spinner {
      margin-top: 32px;
      width: 40px;
      height: 40px;
      border: 3px solid var(--admin-border);
      border-top-color: var(--admin-accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    /* ===== DECAP CMS CUSTOM STYLING ===== */
    
    /* Main app container */
    #nc-root {
      font-family: 'Lora', 'Georgia', serif !important;
    }

    /* Top bar / Header */
    [class*="AppHeader"] {
      background: var(--admin-surface) !important;
      border-bottom: 1px solid var(--admin-border) !important;
      box-shadow: var(--shadow-paper) !important;
    }

    [class*="AppHeader"]::before {
      content: '';
      position: absolute;
      inset: 0;
      opacity: 0.02;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='paper'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23paper)'/%3E%3C/svg%3E");
    }

    /* Sidebar */
    [class*="Sidebar"],
    [class*="sidebar"] {
      background: var(--admin-bg-secondary) !important;
      border-right: 1px solid var(--admin-border) !important;
    }

    /* Collection list items */
    [class*="SidebarNavLink"],
    [class*="NavLink"] {
      font-family: 'Lora', 'Georgia', serif !important;
      color: var(--admin-text) !important;
      border-radius: 8px !important;
      margin: 4px 8px !important;
      transition: all 0.2s ease !important;
    }

    [class*="SidebarNavLink"]:hover,
    [class*="NavLink"]:hover {
      background: var(--admin-surface-hover) !important;
      color: var(--admin-accent) !important;
    }

    [class*="SidebarNavLink"][class*="active"],
    [class*="NavLink"][class*="active"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
    }

    /* Main content area */
    [class*="MainView"],
    [class*="main"],
    main {
      background: var(--admin-bg) !important;
    }

    /* Cards and panels */
    [class*="Card"],
    [class*="EntryCard"],
    [class*="card"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 12px !important;
      box-shadow: var(--shadow-paper) !important;
      transition: all 0.3s ease !important;
    }

    [class*="Card"]:hover,
    [class*="EntryCard"]:hover {
      transform: translateY(-2px) !important;
    }

    /* Buttons - Primary */
    button[class*="primary"],
    [class*="Button"][class*="primary"],
    button[type="submit"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
      border: none !important;
      border-radius: 8px !important;
      font-family: 'Lora', 'Georgia', serif !important;
      font-weight: 500 !important;
      padding: 10px 20px !important;
      box-shadow: 0 4px 12px rgba(139, 90, 43, 0.25) !important;
      transition: all 0.2s ease !important;
    }

    button[class*="primary"]:hover,
    [class*="Button"][class*="primary"]:hover {
      background: var(--admin-accent-hover) !important;
      transform: translateY(-1px) !important;
    }

    /* Buttons - Secondary */
    button:not([class*="primary"]),
    [class*="Button"]:not([class*="primary"]) {
      background: var(--admin-surface) !important;
      color: var(--admin-text) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 8px !important;
      font-family: 'Lora', 'Georgia', serif !important;
      transition: all 0.2s ease !important;
    }

    button:not([class*="primary"]):hover {
      background: var(--admin-surface-hover) !important;
      border-color: var(--admin-accent) !important;
    }

    /* Form inputs */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="number"],
    input[type="url"],
    textarea,
    select,
    [class*="Input"],
    [class*="TextArea"],
    [class*="Select"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 8px !important;
      font-family: 'Lora', 'Georgia', serif !important;
      color: var(--admin-text) !important;
      padding: 12px 16px !important;
      transition: all 0.2s ease !important;
    }

    input:focus,
    textarea:focus,
    select:focus,
    [class*="Input"]:focus,
    [class*="TextArea"]:focus {
      outline: none !important;
      border-color: var(--admin-accent) !important;
      box-shadow: 0 0 0 3px hsla(28 60% 45% / 0.15) !important;
    }

    /* ===== FIX: PARAGRAPH/TEXT VISIBILITY ===== */
    /* Make all text content visible */
    p, span, div, li, td, th, label, a {
      color: var(--admin-text) !important;
    }

    /* Muted text */
    [class*="muted"], [class*="secondary"], [class*="hint"], [class*="description"] {
      color: var(--admin-text-muted) !important;
    }

    /* Ensure editor content is visible */
    [class*="ControlPaneContainer"] p,
    [class*="ControlPaneContainer"] span,
    [class*="ControlPaneContainer"] div,
    [class*="EditorControl"] p,
    [class*="EditorControl"] span,
    [class*="Editor"] p,
    [class*="Editor"] span,
    .ProseMirror p,
    .ProseMirror span,
    .CodeMirror-line,
    .CodeMirror-line span {
      color: var(--admin-text) !important;
    }

    /* Markdown preview text */
    [class*="Preview"] p,
    [class*="Preview"] span,
    [class*="Preview"] li,
    [class*="preview"] p {
      color: var(--admin-text) !important;
    }

    /* Labels */
    label,
    [class*="Label"],
    [class*="FieldLabel"] {
      font-family: 'Cormorant Garamond', 'Georgia', serif !important;
      font-size: 14px !important;
      font-weight: 600 !important;
      color: var(--admin-text) !important;
      text-transform: uppercase !important;
      letter-spacing: 1px !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6,
    [class*="Heading"] {
      font-family: 'Cormorant Garamond', 'Georgia', serif !important;
      color: var(--admin-text) !important;
    }

    /* Entry listing */
    [class*="EntryListing"],
    [class*="ListView"] {
      padding: 24px !important;
    }

    /* Table styles */
    table,
    [class*="Table"] {
      background: var(--admin-surface) !important;
      border-radius: 12px !important;
      overflow: hidden !important;
      border: 1px solid var(--admin-border) !important;
    }

    th {
      background: var(--admin-surface-hover) !important;
      font-family: 'Cormorant Garamond', 'Georgia', serif !important;
      font-weight: 600 !important;
      text-transform: uppercase !important;
      letter-spacing: 1px !important;
      font-size: 12px !important;
      color: var(--admin-text-muted) !important;
    }

    tr:hover {
      background: var(--admin-surface-hover) !important;
    }

    /* Editor panel */
    [class*="EditorControlPane"],
    [class*="ControlPane"],
    [class*="EditorControl"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 12px !important;
      padding: 24px !important;
      margin-bottom: 16px !important;
    }

    /* Rich text editor / Markdown editor */
    [class*="MarkdownControl"],
    [class*="RichText"],
    .ProseMirror,
    .CodeMirror {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 8px !important;
      font-family: 'Spectral', 'Georgia', serif !important;
      font-size: 16px !important;
      line-height: 1.8 !important;
      color: var(--admin-text) !important;
    }

    /* ===== CRITICAL FIX: PROSEMIRROR TEXT VISIBILITY ===== */
    /* Force all text inside ProseMirror editor to be visible */
    .ProseMirror,
    .ProseMirror *,
    .ProseMirror p,
    .ProseMirror span,
    .ProseMirror div,
    .ProseMirror li,
    .ProseMirror h1,
    .ProseMirror h2,
    .ProseMirror h3,
    .ProseMirror h4,
    .ProseMirror blockquote,
    .ProseMirror code,
    .ProseMirror pre,
    [data-slate-editor] *,
    [data-slate-node] *,
    [contenteditable="true"] *,
    [class*="VisualEditor"] *,
    [class*="RichTextEditor"] *,
    [class*="EditorContent"] *,
    [class*="editor-content"] * {
      color: var(--admin-text) !important;
      caret-color: var(--admin-text) !important;
    }

    /* Placeholder text */
    .ProseMirror p.is-empty::before,
    .ProseMirror .placeholder,
    [class*="placeholder"] {
      color: var(--admin-text-muted) !important;
    }

    /* Ensure parent containers don't hide text */
    [class*="WidgetPreviewContainer"],
    [class*="EditorContainer"],
    [class*="ObjectWidgetTopBar"] ~ div,
    [class*="ListItemTopBar"] ~ div {
      color: var(--admin-text) !important;
    }

    /* Nested object/list content */
    [class*="NestedObjectLabel"],
    [class*="ObjectControl"],
    [class*="ListControl"] {
      color: var(--admin-text) !important;
    }

    [class*="ObjectControl"] *,
    [class*="ListControl"] * {
      color: var(--admin-text) !important;
    }

    /* ===== CRITICAL FIX: TOOLBAR NOT COVERING CONTENT ===== */
    /* Ensure markdown/editor container uses proper flex layout */
    [class*="MarkdownControl"],
    [class*="EditorControl"],
    [class*="VisualEditor"] {
      display: flex !important;
      flex-direction: column !important;
    }

    /* Editor wrapper - ensure it flows correctly */
    [class*="MarkdownControl"] > div,
    [class*="EditorControl"] > div {
      display: flex !important;
      flex-direction: column !important;
    }

    /* Toolbar - FIXED position at top, not overlapping */
    [class*="MarkdownControl"] [class*="Toolbar"],
    [class*="EditorToolbar"],
    [class*="VisualEditor"] > div:first-child,
    .ProseMirror-menubar {
      position: sticky !important;
      top: 0 !important;
      z-index: 100 !important;
      background: var(--admin-surface-hover) !important;
      border-bottom: 1px solid var(--admin-border) !important;
      margin-bottom: 0 !important;
      flex-shrink: 0 !important;
      padding: 8px 12px !important;
      border-radius: 8px 8px 0 0 !important;
    }

    /* Content area below toolbar - proper spacing */
    [class*="MarkdownControl"] .ProseMirror,
    [class*="EditorContent"],
    [class*="VisualEditor"] [contenteditable="true"],
    .ProseMirror-content,
    .ProseMirror {
      position: relative !important;
      z-index: 1 !important;
      margin-top: 0 !important;
      padding: 20px !important;
      padding-top: 24px !important;
      min-height: 180px !important;
      background: var(--admin-surface) !important;
      border-radius: 0 0 8px 8px !important;
    }

    /* Force the text to appear below toolbar - NOT overlapped */
    [class*="MarkdownControl"] [class*="editor-wrapper"],
    [class*="EditorControl"] [class*="editor"] {
      margin-top: 0 !important;
      padding-top: 0 !important;
    }

    /* Extra fix: Ensure ProseMirror text is not hidden by toolbar */
    .ProseMirror p:first-child,
    [contenteditable="true"] p:first-child,
    [contenteditable="true"] > *:first-child {
      margin-top: 0 !important;
      padding-top: 0 !important;
    }

    /* Ensure textarea for markdown raw mode is visible */
    [class*="RawEditor"] textarea,
    [class*="MarkdownControl"] textarea {
      color: var(--admin-text) !important;
      background: var(--admin-surface) !important;
      padding: 20px !important;
      min-height: 180px !important;
      font-family: 'Spectral', serif !important;
      font-size: 16px !important;
      line-height: 1.8 !important;
      margin-top: 0 !important;
    }

    /* ===== BETTER NESTED WIDGET STYLING ===== */
    /* List item cards - make them cleaner */
    [class*="ListItem"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 12px !important;
      margin-bottom: 12px !important;
      overflow: hidden !important;
    }

    /* List item header/topbar */
    [class*="ListItemTopBar"],
    [class*="ObjectWidgetTopBar"] {
      background: var(--admin-surface-hover) !important;
      border-bottom: 1px solid var(--admin-border) !important;
      padding: 12px 16px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: space-between !important;
    }

    /* Nested content padding */
    [class*="ListItem"] > div:last-child,
    [class*="ObjectWidget"] > div:last-child {
      padding: 16px !important;
    }

    /* Collapse/expand toggle */
    [class*="CollapseToggle"],
    [class*="ExpandButton"] {
      color: var(--admin-text-muted) !important;
      cursor: pointer !important;
      transition: color 0.2s ease !important;
    }

    [class*="CollapseToggle"]:hover,
    [class*="ExpandButton"]:hover {
      color: var(--admin-accent) !important;
    }

    /* Add button in list */
    [class*="ListControl"] > button,
    button[class*="AddButton"] {
      background: var(--admin-surface) !important;
      border: 2px dashed var(--admin-border) !important;
      border-radius: 10px !important;
      padding: 16px !important;
      margin-top: 8px !important;
      color: var(--admin-text-muted) !important;
      font-family: 'Lora', serif !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
    }

    [class*="ListControl"] > button:hover,
    button[class*="AddButton"]:hover {
      border-color: var(--admin-accent) !important;
      color: var(--admin-accent) !important;
      background: var(--admin-surface-hover) !important;
    }

    /* Type selector dropdown for variable list */
    [class*="TypeSelector"],
    [class*="AddItemButton"] ~ [class*="Dropdown"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 10px !important;
      box-shadow: var(--shadow-paper), 0 10px 40px rgba(0,0,0,0.15) !important;
      padding: 8px !important;
      max-height: 400px !important;
      overflow-y: auto !important;
    }

    /* Type selector items - make them pretty */
    [class*="TypeSelector"] button,
    [class*="TypeMenu"] button {
      display: flex !important;
      align-items: center !important;
      gap: 12px !important;
      padding: 12px 16px !important;
      border-radius: 8px !important;
      margin-bottom: 4px !important;
      font-size: 14px !important;
      font-family: 'Lora', serif !important;
      background: transparent !important;
      border: none !important;
      width: 100% !important;
      text-align: left !important;
      color: var(--admin-text) !important;
      cursor: pointer !important;
      transition: all 0.15s ease !important;
    }

    [class*="TypeSelector"] button:hover,
    [class*="TypeMenu"] button:hover {
      background: var(--admin-surface-hover) !important;
      color: var(--admin-accent) !important;
    }

    /* CodeMirror specific */
    .CodeMirror-cursor {
      border-left-color: var(--admin-text) !important;
    }

    .CodeMirror-selected {
      background: var(--admin-accent) !important;
      opacity: 0.3 !important;
    }

    /* CodeMirror lines must be visible */
    .CodeMirror pre,
    .CodeMirror-line,
    .CodeMirror-line *,
    .CodeMirror-code * {
      color: var(--admin-text) !important;
    }

    /* Toolbar */
    [class*="Toolbar"],
    [class*="toolbar"] {
      background: var(--admin-surface-hover) !important;
      border-bottom: 1px solid var(--admin-border) !important;
      border-radius: 8px 8px 0 0 !important;
    }

    /* Dropdown menus */
    [class*="Dropdown"],
    [class*="Menu"],
    [class*="dropdown"],
    [class*="menu"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 8px !important;
      box-shadow: var(--shadow-paper) !important;
    }

    /* Dropdown items */
    [class*="DropdownItem"],
    [class*="MenuItem"] {
      font-family: 'Lora', 'Georgia', serif !important;
      color: var(--admin-text) !important;
      transition: all 0.15s ease !important;
    }

    [class*="DropdownItem"]:hover,
    [class*="MenuItem"]:hover {
      background: var(--admin-surface-hover) !important;
      color: var(--admin-accent) !important;
    }

    /* ===== ENHANCED MODAL / DIALOG STYLING ===== */
    [class*="Modal"],
    [class*="Dialog"],
    [class*="ConfirmDialog"],
    [class*="AlertDialog"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 20px !important;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.35) !important;
      padding: 0 !important;
      overflow: hidden !important;
      animation: modalSlideIn 0.35s cubic-bezier(0.16, 1, 0.3, 1) !important;
      max-width: 420px !important;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    [class*="ModalOverlay"],
    [class*="DialogOverlay"],
    [class*="Backdrop"] {
      background: hsla(220 15% 5% / 0.75) !important;
      backdrop-filter: blur(8px) !important;
      animation: fadeIn 0.2s ease !important;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Modal Header */
    [class*="Modal"] header,
    [class*="Dialog"] header,
    [class*="ModalHeader"],
    [class*="DialogHeader"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
      padding: 20px 24px !important;
      font-family: 'Cormorant Garamond', serif !important;
      font-size: 18px !important;
      font-weight: 600 !important;
      border-bottom: none !important;
    }

    /* Modal Body */
    [class*="Modal"] [class*="Body"],
    [class*="Dialog"] [class*="Body"],
    [class*="ModalBody"],
    [class*="DialogBody"],
    [class*="ConfirmDialog"] > div:not(:first-child):not(:last-child) {
      padding: 24px !important;
      color: var(--admin-text) !important;
      font-family: 'Lora', serif !important;
      font-size: 15px !important;
      line-height: 1.7 !important;
    }

    /* Modal Footer / Buttons */
    [class*="Modal"] footer,
    [class*="Dialog"] footer,
    [class*="ModalFooter"],
    [class*="DialogFooter"],
    [class*="Modal"] [class*="Actions"],
    [class*="Dialog"] [class*="Actions"] {
      padding: 16px 24px 24px !important;
      display: flex !important;
      gap: 12px !important;
      justify-content: flex-end !important;
      background: var(--admin-surface) !important;
      border-top: 1px solid var(--admin-border) !important;
    }

    /* Modal Buttons - Primary (Confirm/OK) */
    [class*="Modal"] button[class*="primary"],
    [class*="Dialog"] button[class*="primary"],
    [class*="ConfirmButton"],
    [class*="Modal"] button:first-child:not([class*="cancel"]):not([class*="secondary"]) {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
      border: none !important;
      border-radius: 10px !important;
      padding: 12px 24px !important;
      font-weight: 500 !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
    }

    [class*="Modal"] button[class*="primary"]:hover,
    [class*="Dialog"] button[class*="primary"]:hover {
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(139, 90, 43, 0.3) !important;
    }

    /* Modal Buttons - Secondary (Cancel) */
    [class*="Modal"] button[class*="cancel"],
    [class*="Modal"] button[class*="secondary"],
    [class*="Dialog"] button[class*="cancel"],
    [class*="CancelButton"] {
      background: var(--admin-surface) !important;
      color: var(--admin-text) !important;
      border: 2px solid var(--admin-border) !important;
      border-radius: 10px !important;
      padding: 12px 24px !important;
      font-weight: 500 !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
    }

    [class*="Modal"] button[class*="cancel"]:hover,
    [class*="CancelButton"]:hover {
      background: var(--admin-surface-hover) !important;
      border-color: var(--admin-accent) !important;
    }

    /* Delete/Danger Modal */
    [class*="DeleteModal"] header,
    [class*="Modal"][class*="danger"] header,
    [class*="ConfirmDelete"] header {
      background: hsl(0 60% 50%) !important;
    }

    [class*="DeleteModal"] button[class*="primary"],
    [class*="Modal"][class*="danger"] button[class*="primary"] {
      background: hsl(0 60% 50%) !important;
    }

    [class*="DeleteModal"] button[class*="primary"]:hover {
      background: hsl(0 55% 45%) !important;
    }

    /* Toast / Notifications - Enhanced Style */
    [class*="Toast"],
    [class*="Notification"],
    [class*="Snackbar"] {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 16px !important;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2), var(--shadow-paper) !important;
      font-family: 'Lora', 'Georgia', serif !important;
      color: var(--admin-text) !important;
      padding: 16px 20px !important;
      animation: slideInUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) !important;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Success state */
    [class*="success"],
    [class*="Success"] {
      border-left: 4px solid hsl(142 60% 40%) !important;
      background: linear-gradient(135deg, var(--admin-surface) 0%, hsl(142 40% 97%) 100%) !important;
    }

    .dark [class*="success"],
    .dark [class*="Success"] {
      background: linear-gradient(135deg, var(--admin-surface) 0%, hsl(142 30% 15%) 100%) !important;
    }

    /* Error state */
    [class*="error"],
    [class*="Error"] {
      border-left: 4px solid hsl(0 60% 50%) !important;
      background: linear-gradient(135deg, var(--admin-surface) 0%, hsl(0 40% 97%) 100%) !important;
    }

    .dark [class*="error"],
    .dark [class*="Error"] {
      background: linear-gradient(135deg, var(--admin-surface) 0%, hsl(0 30% 15%) 100%) !important;
    }

    /* Warning state */
    [class*="warning"],
    [class*="Warning"] {
      border-left: 4px solid hsl(45 80% 50%) !important;
      background: linear-gradient(135deg, var(--admin-surface) 0%, hsl(45 60% 96%) 100%) !important;
    }

    .dark [class*="warning"],
    .dark [class*="Warning"] {
      background: linear-gradient(135deg, var(--admin-surface) 0%, hsl(45 40% 15%) 100%) !important;
    }

    /* Image widget */
    [class*="ImageWidget"],
    [class*="FileWidget"] {
      background: var(--admin-surface) !important;
      border: 2px dashed var(--admin-border) !important;
      border-radius: 12px !important;
      transition: all 0.2s ease !important;
    }

    [class*="ImageWidget"]:hover,
    [class*="FileWidget"]:hover {
      border-color: var(--admin-accent) !important;
      background: var(--admin-surface-hover) !important;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: var(--admin-bg-secondary);
      border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--admin-border);
      border-radius: 5px;
      border: 2px solid var(--admin-bg-secondary);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--admin-accent);
    }

    /* ===== LOGIN SCREEN STYLING ===== */
    [class*="LoginPage"],
    [class*="AuthenticationPage"] {
      background: var(--admin-bg) !important;
      min-height: 100vh !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }

    [class*="LoginButton"],
    [class*="AuthButton"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
      border-radius: 12px !important;
      padding: 16px 32px !important;
      font-size: 16px !important;
      font-weight: 500 !important;
      box-shadow: 0 4px 20px rgba(139, 90, 43, 0.3) !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
    }

    [class*="LoginButton"]:hover,
    [class*="AuthButton"]:hover {
      transform: translateY(-2px) !important;
    }

    /* ===== NETLIFY IDENTITY WIDGET STYLING ===== */
    .netlify-identity-widget {
      font-family: 'Lora', 'Georgia', serif !important;
    }

    .netlify-identity-widget-modal {
      background: hsla(220 15% 10% / 0.7) !important;
      backdrop-filter: blur(8px) !important;
    }

    .netlify-identity-widget-modal-content {
      background: var(--admin-surface) !important;
      border: 1px solid var(--admin-border) !important;
      border-radius: 20px !important;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.35) !important;
      overflow: hidden !important;
      max-width: 420px !important;
    }

    .netlify-identity-widget-modal-content::before {
      content: '';
      position: absolute;
      inset: 0;
      opacity: 0.03;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='paper'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23paper)'/%3E%3C/svg%3E");
    }

    /* Widget Header */
    .netlify-identity-widget-modal-content header,
    .netlify-identity-widget header {
      background: var(--admin-accent) !important;
      padding: 28px 24px !important;
      text-align: center !important;
    }

    .netlify-identity-widget-modal-content header h1,
    .netlify-identity-widget header h1,
    .netlify-identity-widget .logo {
      font-family: 'Cormorant Garamond', 'Georgia', serif !important;
      font-size: 28px !important;
      font-weight: 600 !important;
      color: var(--admin-surface) !important;
      margin: 0 !important;
    }

    /* Widget Form */
    .netlify-identity-widget form,
    .netlify-identity-widget-modal-content form {
      padding: 32px 28px !important;
    }

    .netlify-identity-widget input[type="email"],
    .netlify-identity-widget input[type="password"],
    .netlify-identity-widget input[type="text"],
    .netlify-identity-widget-modal-content input {
      background: var(--admin-surface) !important;
      border: 2px solid var(--admin-border) !important;
      border-radius: 10px !important;
      font-family: 'Lora', 'Georgia', serif !important;
      font-size: 15px !important;
      color: var(--admin-text) !important;
      padding: 14px 18px !important;
      width: 100% !important;
      transition: all 0.2s ease !important;
      box-sizing: border-box !important;
    }

    .netlify-identity-widget input:focus,
    .netlify-identity-widget-modal-content input:focus {
      outline: none !important;
      border-color: var(--admin-accent) !important;
      box-shadow: 0 0 0 4px hsla(28 60% 45% / 0.15) !important;
    }

    .netlify-identity-widget label,
    .netlify-identity-widget-modal-content label {
      font-family: 'Cormorant Garamond', 'Georgia', serif !important;
      font-size: 13px !important;
      font-weight: 600 !important;
      color: var(--admin-text-muted) !important;
      text-transform: uppercase !important;
      letter-spacing: 1.5px !important;
      margin-bottom: 8px !important;
      display: block !important;
    }

    /* Widget Buttons */
    .netlify-identity-widget button[type="submit"],
    .netlify-identity-widget .btn,
    .netlify-identity-widget-modal-content button[type="submit"] {
      background: var(--admin-accent) !important;
      color: var(--admin-surface) !important;
      border: none !important;
      border-radius: 10px !important;
      font-family: 'Lora', 'Georgia', serif !important;
      font-size: 15px !important;
      font-weight: 500 !important;
      padding: 14px 28px !important;
      width: 100% !important;
      cursor: pointer !important;
      box-shadow: 0 4px 15px rgba(139, 90, 43, 0.25) !important;
      transition: all 0.3s ease !important;
      text-transform: none !important;
    }

    .netlify-identity-widget button[type="submit"]:hover,
    .netlify-identity-widget .btn:hover {
      transform: translateY(-2px) !important;
    }

    /* Secondary buttons / links */
    .netlify-identity-widget a,
    .netlify-identity-widget .btnLink,
    .netlify-identity-widget-modal-content a {
      color: var(--admin-accent) !important;
      font-family: 'Lora', 'Georgia', serif !important;
      text-decoration: none !important;
      transition: color 0.2s ease !important;
    }

    .netlify-identity-widget a:hover {
      color: var(--admin-accent-hover) !important;
      text-decoration: underline !important;
    }

    /* Tab navigation */
    .netlify-identity-widget .tabs,
    .netlify-identity-widget-modal-content .tabs {
      display: flex !important;
      border-bottom: 2px solid var(--admin-border) !important;
      margin-bottom: 24px !important;
    }

    .netlify-identity-widget .tab,
    .netlify-identity-widget-modal-content .tab {
      flex: 1 !important;
      padding: 12px !important;
      text-align: center !important;
      font-family: 'Cormorant Garamond', 'Georgia', serif !important;
      font-size: 14px !important;
      font-weight: 600 !important;
      text-transform: uppercase !important;
      letter-spacing: 1px !important;
      color: var(--admin-text-muted) !important;
      border-bottom: 2px solid transparent !important;
      margin-bottom: -2px !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
    }

    .netlify-identity-widget .tab.active,
    .netlify-identity-widget .tab:hover {
      color: var(--admin-accent) !important;
      border-bottom-color: var(--admin-accent) !important;
    }

    /* Provider buttons (GitHub, etc) */
    .netlify-identity-widget .providers,
    .netlify-identity-widget-modal-content .providers {
      margin-top: 20px !important;
      padding-top: 20px !important;
      border-top: 1px solid var(--admin-border) !important;
    }

    .netlify-identity-widget .provider-button,
    .netlify-identity-widget button.provider {
      background: var(--admin-surface) !important;
      border: 2px solid var(--admin-border) !important;
      border-radius: 10px !important;
      padding: 12px 20px !important;
      font-family: 'Lora', 'Georgia', serif !important;
      font-size: 14px !important;
      color: var(--admin-text) !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 10px !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
    }

    .netlify-identity-widget .provider-button:hover,
    .netlify-identity-widget button.provider:hover {
      background: var(--admin-surface-hover) !important;
      border-color: var(--admin-accent) !important;
      transform: translateY(-1px) !important;
    }

    /* Error messages */
    .netlify-identity-widget .error,
    .netlify-identity-widget-modal-content .error {
      background: hsl(0 60% 97%) !important;
      border: 1px solid hsl(0 50% 80%) !important;
      color: hsl(0 60% 40%) !important;
      padding: 12px 16px !important;
      border-radius: 8px !important;
      font-size: 14px !important;
      margin-bottom: 16px !important;
    }

    .dark .netlify-identity-widget .error,
    .dark .netlify-identity-widget-modal-content .error {
      background: hsl(0 50% 15%) !important;
      border-color: hsl(0 40% 35%) !important;
      color: hsl(0 70% 70%) !important;
    }

    /* Success messages */
    .netlify-identity-widget .success {
      background: hsl(142 50% 95%) !important;
      border: 1px solid hsl(142 40% 75%) !important;
      color: hsl(142 50% 30%) !important;
      padding: 12px 16px !important;
      border-radius: 8px !important;
    }

    .dark .netlify-identity-widget .success {
      background: hsl(142 40% 15%) !important;
      border-color: hsl(142 30% 35%) !important;
      color: hsl(142 60% 70%) !important;
    }

    /* Close button */
    .netlify-identity-widget .close,
    .netlify-identity-widget-modal-content .close {
      position: absolute !important;
      top: 16px !important;
      right: 16px !important;
      width: 32px !important;
      height: 32px !important;
      background: hsla(45 30% 96% / 0.2) !important;
      border: none !important;
      border-radius: 50% !important;
      cursor: pointer !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      transition: background 0.2s ease !important;
    }

    .netlify-identity-widget .close:hover {
      background: hsla(45 30% 96% / 0.4) !important;
    }

    /* ===== PUBLISH BUTTON ===== */
    [class*="PublishButton"],
    button[class*="publish"] {
      background: linear-gradient(135deg, hsl(142 50% 40%) 0%, hsl(142 45% 35%) 100%) !important;
    }

    /* Draft indicator */
    [class*="Draft"],
    [class*="draft"] {
      background: hsl(45 70% 85%) !important;
      color: hsl(35 70% 30%) !important;
      border-radius: 6px !important;
      padding: 4px 12px !important;
      font-size: 11px !important;
      text-transform: uppercase !important;
      letter-spacing: 1px !important;
    }

    .dark [class*="Draft"],
    .dark [class*="draft"] {
      background: hsl(45 50% 25%) !important;
      color: hsl(45 70% 75%) !important;
    }

    /* Decorative elements */
    [class*="Logo"] img {
      filter: sepia(20%) !important;
    }

    .dark [class*="Logo"] img {
      filter: sepia(20%) invert(1) !important;
    }

    /* ===== CUSTOM CONFIRM DIALOG STYLES ===== */
    #custom-confirm-overlay {
      position: fixed;
      inset: 0;
      background: hsla(220 15% 5% / 0);
      backdrop-filter: blur(0px);
      z-index: 999999;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      transition: all 0.3s ease;
    }

    #custom-confirm-overlay.visible {
      background: hsla(220 15% 5% / 0.75);
      backdrop-filter: blur(8px);
      pointer-events: auto;
    }

    .custom-confirm-dialog {
      background: var(--admin-surface);
      border: 1px solid var(--admin-border);
      border-radius: 20px;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
      width: 90%;
      max-width: 400px;
      overflow: hidden;
      opacity: 0;
      transform: scale(0.9) translateY(-20px);
      transition: all 0.35s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .custom-confirm-dialog.visible {
      opacity: 1;
      transform: scale(1) translateY(0);
    }

    .custom-confirm-header {
      background: var(--admin-accent);
      color: var(--admin-surface);
      padding: 20px 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .custom-confirm-icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    .custom-confirm-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      font-weight: 600;
    }

    .custom-confirm-body {
      padding: 24px;
    }

    .custom-confirm-message {
      font-family: 'Lora', serif;
      font-size: 15px;
      line-height: 1.7;
      color: var(--admin-text);
      margin: 0;
    }

    .custom-confirm-footer {
      padding: 16px 24px 24px;
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      border-top: 1px solid var(--admin-border);
    }

    .custom-confirm-cancel {
      background: var(--admin-surface);
      color: var(--admin-text);
      border: 2px solid var(--admin-border);
      border-radius: 10px;
      padding: 12px 24px;
      font-family: 'Lora', serif;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .custom-confirm-cancel:hover {
      background: var(--admin-surface-hover);
      border-color: var(--admin-accent);
    }

    .custom-confirm-ok {
      background: var(--admin-accent);
      color: var(--admin-surface);
      border: none;
      border-radius: 10px;
      padding: 12px 24px;
      font-family: 'Lora', serif;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(139, 90, 43, 0.25);
    }

    .custom-confirm-ok:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(139, 90, 43, 0.35);
    }

    .custom-confirm-ok:focus {
      outline: none;
      box-shadow: 0 0 0 3px hsla(28 60% 45% / 0.3), 0 4px 12px rgba(139, 90, 43, 0.25);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      [class*="Sidebar"] {
        background: var(--admin-surface) !important;
      }

      .netlify-identity-widget-modal-content {
        margin: 16px !important;
        border-radius: 16px !important;
      }

      .netlify-identity-widget form {
        padding: 24px 20px !important;
      }

      .theme-toggle-container {
        top: 8px;
        right: 8px;
        padding: 6px 10px;
      }

      .theme-toggle-label {
        display: none;
      }

      .custom-confirm-dialog {
        margin: 16px;
      }

      .custom-confirm-footer {
        flex-direction: column-reverse;
      }

      .custom-confirm-cancel,
      .custom-confirm-ok {
        width: 100%;
      }
    }
  </style>

</head>
<body>
  <!-- Preview Overlay -->
  <div id="preview-overlay"></div>

  <!-- Article Preview Panel -->
  <div id="article-preview-panel">
    <div class="preview-header">
      <h3>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
        Preview Artikel
      </h3>
      <div style="display: flex; gap: 8px; align-items: center;">
        <button class="preview-refresh-btn" id="preview-refresh">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 4v6h-6M1 20v-6h6"/>
            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
          </svg>
          Refresh
        </button>
        <button class="preview-close-btn" id="preview-close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="preview-content" id="preview-content">
      <div class="preview-placeholder">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
        </svg>
        <p>Mulai edit artikel untuk melihat preview di sini</p>
      </div>
    </div>
  </div>

  <!-- Custom Loading Screen -->
  <div class="admin-loading" id="admin-loading">
    <div class="loading-logo">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path>
        <line x1="16" y1="8" x2="2" y2="22"></line>
        <line x1="17.5" y1="15" x2="9" y2="15"></line>
      </svg>
    </div>
    <div class="loading-title">Sophrosyne</div>
    <div class="loading-subtitle">Admin Panel</div>
    <div class="loading-spinner"></div>
  </div>

  <!-- Container untuk Decap CMS mounting -->
  <div id="nc-root"></div>

  <!-- Netlify Identity Widget (required for invite/recovery tokens + GitHub OAuth bridge) -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <!-- Decap CMS Script - HARUS di akhir body setelah DOM siap -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

  <script>
    // ===== ARTICLE PREVIEW FUNCTIONALITY =====
    (function() {
      function initPreview() {
        const panel = document.getElementById('article-preview-panel');
        const overlay = document.getElementById('preview-overlay');
        const closeBtn = document.getElementById('preview-close');
        const refreshBtn = document.getElementById('preview-refresh');
        const previewContent = document.getElementById('preview-content');
        
        if (!panel) return;

        // Toggle functions
        function openPreview() {
          panel.classList.add('visible');
          overlay.classList.add('visible');
          updatePreview();
        }

        function closePreview() {
          panel.classList.remove('visible');
          overlay.classList.remove('visible');
        }

        function updatePreview() {
          // Get values from CMS form
          const titleInput = document.querySelector('input[id*="title"], [data-field-name="title"] input');
          const excerptInput = document.querySelector('textarea[id*="excerpt"], [data-field-name="excerpt"] textarea, [data-field-name="excerpt"] input');
          const categorySelect = document.querySelector('select[id*="category"], [data-field-name="category"] select, [data-field-name="category"] input');
          const dateInput = document.querySelector('input[type="date"], [data-field-name="date"] input');
          const imageInput = document.querySelector('[data-field-name="image"] img, [class*="ImageWidget"] img');
          const tagsContainer = document.querySelectorAll('[data-field-name="tags"] [class*="Tag"], [data-field-name="tags"] span');
          const contentBlocks = document.querySelectorAll('[data-field-name="content"] [class*="ListItem"]');
          
          const title = titleInput?.value || 'Judul Artikel';
          const excerpt = excerptInput?.value || 'Ringkasan artikel akan muncul di sini...';
          const category = categorySelect?.value || categorySelect?.textContent || 'Kategori';
          const date = dateInput?.value || new Date().toISOString().split('T')[0];
          const imageSrc = imageInput?.src || '';
          
          // Collect tags
          let tagsHtml = '';
          tagsContainer.forEach(tag => {
            const text = tag.textContent?.trim();
            if (text && text.length < 30) {
              tagsHtml += `<span class="preview-tag">${text}</span>`;
            }
          });

          // Collect content blocks preview
          let blocksHtml = '';
          contentBlocks.forEach(block => {
            const typeLabel = block.querySelector('[class*="TopBar"] span, [class*="Label"]')?.textContent || '';
            const textContent = block.querySelector('.ProseMirror p, textarea, input[type="text"]')?.textContent || 
                               block.querySelector('.ProseMirror p, textarea, input[type="text"]')?.value || '';
            
            if (typeLabel.toLowerCase().includes('heading') || typeLabel.toLowerCase().includes('judul')) {
              const headingText = block.querySelector('input')?.value || textContent;
              if (headingText) {
                blocksHtml += `<h2>${headingText}</h2>`;
              }
            } else if (typeLabel.toLowerCase().includes('paragraph') || typeLabel.toLowerCase().includes('paragraf')) {
              if (textContent) {
                blocksHtml += `<p>${textContent}</p>`;
              }
            } else if (typeLabel.toLowerCase().includes('quote') || typeLabel.toLowerCase().includes('kutipan')) {
              if (textContent) {
                blocksHtml += `<blockquote>${textContent}</blockquote>`;
              }
            } else if (textContent) {
              blocksHtml += `<p>${textContent}</p>`;
            }
          });

          previewContent.innerHTML = `
            <div class="preview-article">
              ${imageSrc ? `<img src="${imageSrc}" alt="Cover" class="preview-image" onerror="this.style.display='none'">` : ''}
              <h1>${title}</h1>
              <div class="preview-meta">
                <span> ${category}</span>
                <span> ${formatDate(date)}</span>
              </div>
              ${tagsHtml ? `<div class="preview-tags">${tagsHtml}</div>` : ''}
              <div class="preview-excerpt">${excerpt}</div>
              ${blocksHtml ? `<div class="preview-content-blocks">${blocksHtml}</div>` : ''}
            </div>
          `;
        }

        function formatDate(dateStr) {
          try {
            const date = new Date(dateStr);
            return date.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
          } catch {
            return dateStr;
          }
        }

        // Event listeners
        closeBtn?.addEventListener('click', closePreview);
        overlay?.addEventListener('click', closePreview);
        refreshBtn?.addEventListener('click', updatePreview);

        // Keyboard shortcut (Escape to close)
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && panel.classList.contains('visible')) {
            closePreview();
          }
        });

        // Add preview button to header when CMS loads
        function addPreviewButton() {
          const header = document.querySelector('[class*="AppHeader"], [class*="EditorHeader"], header');
          if (!header) return;

          // Check if button already exists
          if (document.getElementById('preview-toggle')) return;

          // Find the right section of header (or create container)
          let actionsContainer = header.querySelector('[class*="Actions"], [class*="RightSection"]');
          if (!actionsContainer) {
            actionsContainer = document.createElement('div');
            actionsContainer.style.cssText = 'display: flex; align-items: center; gap: 12px; margin-left: auto;';
            header.appendChild(actionsContainer);
          }

          // Create preview button
          const previewBtn = document.createElement('button');
          previewBtn.id = 'preview-toggle';
          previewBtn.className = 'preview-toggle-btn';
          previewBtn.innerHTML = `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
            Preview
          `;
          previewBtn.addEventListener('click', openPreview);

          // Insert before theme toggle or at end
          const themeToggle = document.getElementById('theme-toggle-container');
          if (themeToggle && actionsContainer.contains(themeToggle)) {
            actionsContainer.insertBefore(previewBtn, themeToggle);
          } else {
            actionsContainer.insertBefore(previewBtn, actionsContainer.firstChild);
          }
        }

        // Also inject theme toggle into header
        function moveThemeToggle() {
          const header = document.querySelector('[class*="AppHeader"], [class*="EditorHeader"], header');
          const existingToggle = document.getElementById('theme-toggle-container');
          if (!header || !existingToggle) return;

          let actionsContainer = header.querySelector('[class*="Actions"], [class*="RightSection"]');
          if (!actionsContainer) {
            actionsContainer = document.createElement('div');
            actionsContainer.style.cssText = 'display: flex; align-items: center; gap: 12px; margin-left: auto;';
            header.appendChild(actionsContainer);
          }

          // Move theme toggle to header
          if (!actionsContainer.contains(existingToggle)) {
            actionsContainer.appendChild(existingToggle);
          }
        }

        // Watch for CMS to load and add buttons
        const observer = new MutationObserver(() => {
          const isEditor = document.querySelector('[class*="EditorControl"], [class*="ControlPane"]');
          if (isEditor) {
            setTimeout(() => {
              addPreviewButton();
              moveThemeToggle();
            }, 500);
          }
        });

        observer.observe(document.body, { childList: true, subtree: true });

        // Initial check
        setTimeout(() => {
          addPreviewButton();
          moveThemeToggle();
        }, 2000);
      }

      // Initialize when DOM ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPreview);
      } else {
        initPreview();
      }
    })();

    // ===== CUSTOM CONFIRM DIALOG (Override native confirm) =====
    (function() {
      // Create custom dialog element
      function createConfirmDialog() {
        const overlay = document.createElement('div');
        overlay.id = 'custom-confirm-overlay';
        overlay.innerHTML = `
          <div class="custom-confirm-dialog">
            <div class="custom-confirm-header">
              <svg class="custom-confirm-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4M12 8h.01"/>
              </svg>
              <span class="custom-confirm-title">Konfirmasi</span>
            </div>
            <div class="custom-confirm-body">
              <p class="custom-confirm-message"></p>
            </div>
            <div class="custom-confirm-footer">
              <button class="custom-confirm-cancel">Batal</button>
              <button class="custom-confirm-ok">Ya, Lanjutkan</button>
            </div>
          </div>
        `;
        document.body.appendChild(overlay);
        return overlay;
      }

      // Custom confirm function
      window.customConfirm = function(message) {
        return new Promise((resolve) => {
          let overlay = document.getElementById('custom-confirm-overlay');
          if (!overlay) {
            overlay = createConfirmDialog();
          }
          
          const dialog = overlay.querySelector('.custom-confirm-dialog');
          const messageEl = overlay.querySelector('.custom-confirm-message');
          const cancelBtn = overlay.querySelector('.custom-confirm-cancel');
          const okBtn = overlay.querySelector('.custom-confirm-ok');
          
          messageEl.textContent = message;
          overlay.classList.add('visible');
          dialog.classList.add('visible');
          
          function cleanup(result) {
            overlay.classList.remove('visible');
            dialog.classList.remove('visible');
            cancelBtn.removeEventListener('click', handleCancel);
            okBtn.removeEventListener('click', handleOk);
            overlay.removeEventListener('click', handleOverlayClick);
            document.removeEventListener('keydown', handleKeydown);
            resolve(result);
          }
          
          function handleCancel() { cleanup(false); }
          function handleOk() { cleanup(true); }
          function handleOverlayClick(e) {
            if (e.target === overlay) cleanup(false);
          }
          function handleKeydown(e) {
            if (e.key === 'Escape') cleanup(false);
            if (e.key === 'Enter') cleanup(true);
          }
          
          cancelBtn.addEventListener('click', handleCancel);
          okBtn.addEventListener('click', handleOk);
          overlay.addEventListener('click', handleOverlayClick);
          document.addEventListener('keydown', handleKeydown);
          
          // Focus the OK button
          setTimeout(() => okBtn.focus(), 100);
        });
      };
    })();

    // ===== DARK MODE LOGIC =====
    (function() {
      const STORAGE_KEY = 'sophrosyne-admin-theme';
      
      // Check saved preference or system preference
      function getInitialTheme() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) return saved;
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }
      
      // Apply theme
      function applyTheme(theme) {
        if (theme === 'dark') {
          document.body.classList.add('dark');
        } else {
          document.body.classList.remove('dark');
        }
        localStorage.setItem(STORAGE_KEY, theme);
      }
      
      // Initialize immediately (before DOM ready to prevent flash)
      applyTheme(getInitialTheme());
      
      // Setup toggle after DOM ready
      document.addEventListener('DOMContentLoaded', function() {
        const toggle = document.getElementById('theme-toggle');
        if (toggle) {
          toggle.addEventListener('click', function() {
            const isDark = document.body.classList.contains('dark');
            applyTheme(isDark ? 'light' : 'dark');
          });
        }
      });
      
      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem(STORAGE_KEY)) {
          applyTheme(e.matches ? 'dark' : 'light');
        }
      });
    })();

    // ===== NETLIFY IDENTITY HANDLING =====
    (function () {
      if (!window.netlifyIdentity) return;

      const hash = window.location.hash || "";
      const hasToken = hash.includes("invite_token=") || hash.includes("recovery_token=");

      window.netlifyIdentity.on("init", function (user) {
        if (hasToken && !user) {
          window.netlifyIdentity.open();
        }

        window.netlifyIdentity.on("login", function () {
          if (!window.location.pathname.startsWith("/admin")) {
            window.location.assign("/admin/");
          }
        });
      });
    })();

    // Hide loading screen when CMS is ready
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        const loading = document.getElementById('admin-loading');
        if (loading) {
          loading.style.opacity = '0';
          loading.style.transition = 'opacity 0.5s ease';
          setTimeout(function() {
            loading.style.display = 'none';
          }, 500);
        }
      }, 2000);
    });
  </script>
  
  <!-- Theme Toggle (akan dipindahkan ke header via JS) -->
  <div class="theme-toggle-container" id="theme-toggle-container" style="position: fixed; top: 16px; right: 16px;">
    <span class="theme-toggle-label">Mode</span>
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
      <svg class="theme-toggle-icon sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="5"/>
        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
      </svg>
      <svg class="theme-toggle-icon moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
    </button>
  </div>
</body>
</html>
